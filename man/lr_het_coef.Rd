% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lr_het_coef.R
\name{lr_het_coef}
\alias{lr_het_coef}
\title{Compute Long-Run Heterogeneous Coefficients}
\usage{
lr_het_coef(het.coeff, subgroup = NULL, ma = 30, p = 1, q = 4)
}
\arguments{
\item{het.coeff}{A list containing heterogeneous coefficient estimates with the following structure:
\describe{
\item{hpj_coeff}{Matrix of HPJ (Heterogeneous Panel J-estimator) coefficients}
\item{all_coeff}{List containing coefficient matrices from different panel estimations:
\describe{
\item{full}{Full panel coefficient matrix}
\item{panel.1}{First panel subset coefficient matrix}
\item{panel.2}{Second panel subset coefficient matrix}
}
}
}}

\item{p}{Integer. Number of autoregressive lags in the model. Default is 1.}

\item{q}{Integer. Number of explanatory variable lags in the model. Default is 4.}

\item{country_iso}{A vector containing the iso3 codes of countries,}
}
\value{
A list with two elements:
\describe{
\item{lr_coeff}{Numeric. The bias-corrected long-run coefficient (theta hat)}
\item{std_err}{Matrix. Standard errors of the long-run coefficient estimates}
}
}
\description{
This function computes long-run coefficients and their standard errors from
heterogeneous panel data models. It processes coefficient matrices from different
panel estimations and applies bias correction methods to derive the long-run
multiplier and its variance-covariance matrix.
}
\details{
The function performs the following steps:
\enumerate{
\item Filters coefficient matrices to include only countries present in \code{country.vars$iso}
\item Extracts autoregressive coefficients (phi) and explanatory variable coefficients (beta)
\item Computes bias-corrected estimates using cross-sectional averages
\item Calculates the long-run multiplier as: theta = beta / (1 - phi)
\item Constructs variance-covariance matrix from the three panel estimations
\item Applies delta method for standard error calculation of the long-run coefficient
}

The variance calculation uses a complex combination of the variance-covariance matrices
from the full panel and two subpanels, accounting for cross-correlations between
different estimation methods.
}
\note{
This function assumes a specific structure for the coefficient matrices where:
\itemize{
\item Row 1 contains intercept terms
\item Rows 2 to (p+1) contain autoregressive coefficients
\item Rows (p+2) to (p+q+2) contain explanatory variable coefficients
}
}
\examples{
\dontrun{
# Example usage with heterogeneous panel data
het_coeffs <- list(
  hpj_coeff = matrix(rnorm(50), nrow = 10, ncol = 5),
  all_coeff = list(
    full = matrix(rnorm(50), nrow = 10, ncol = 5),
    panel.1 = matrix(rnorm(50), nrow = 10, ncol = 5),
    panel.2 = matrix(rnorm(50), nrow = 10, ncol = 5)
  )
)

country_iso <- c("USA", "DEU", "JPN", "GBR", "FRA")


# Compute long-run coefficients
lr_results <- lr_het_coef(het_coeffs, country_iso, p = 1, q = 4)

# Access results
print(lr_results$lr_coeff)  # Long-run coefficient
print(lr_results$std_err)   # Standard errors
}


}
